<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

</head>
<body>
    <div class="w-full min-h-screen bg-zinc-900 p-10 text-white flex flex-col ">
        <div class="flex flex-col  "></div>
        <a class="text-2xl text-red-500 flex justify-end mr-20" href="/logout">logout</a>
        <a class="text-2xl text-zinc-500 flex justify-end mr-20" href="/profile/upload">update pfp</a>
        <div class=" mt-10 details">
            <!-- multer ke saath adding the profile picture thing -->
            <div class="flex flex-row gap-3 mb-3">
                <div class="w-10 h-10 rounded-md overflow-hidden">
                    <img class="w-full h-full object-cover" src="/images/uploads/<%= user.profilepic %>" alt="">
                </div>
                <h3 class="text-4xl">Hello, <span class="font-light text-blue-500"><%= user.name %> üëãüèº</span></h1>
            </div>

            <h5 class="mt-2">You can create a post -</h5>
            <form class="flex flex-col justify-start" action="/post" method="POST">
                <textarea name="content" placeholder="What's on your mind" class=" block h-25 mb-2 resize-none w-1/3 mt-1 z bg-transparent border-2 border-zinc-800 rounded-md" ></textarea>
                <input class="w-40 mt-1 bg-blue-500 rounded-lg p-1" value="Create a post" type="submit">
            </form>

            <!-- change to foreach  -->

            <div class="posts mt-15">
                <h2 class="text-2xl">Your Posts-</h2>
                <div class="postcontainer mt-4 flex flex-row flex-wrap gap-4">
                    <!-- post is an array of posts and also you want the latest post ot come first so use reverse-->
                    <% user.posts.reverse().forEach(function(post){ %>
                    <div class="post w-1/4 p-4 rounded-md border-2 border-zinc-700 bg-zinc-800 ">
                        <h4 class="text-xl text-blue-400">@<%= user.username%></h4>
                        <p class="text-s mt-1 tracking-tighter"><%= post.content %></p>
                        <small class="mt-2 inline-block "><%= post.likes.length %> likes</small>
                        <div class=" btns flex gap-4 mt-1">
                            <a class="text-blue-500" href="/like/<%=post._id%>">
                                <%= post.likes.indexOf(user._id) === -1 ? "Like" : "Unlike" %>
                            </a>
                            <a class="text-zinc-400" href="/edit/<%=post._id%>"> edit </a>
                            <div class="flex justify-end">
                                <a class="text-red-500" href="/delete/<%=post._id%>">delete</a>
                            </div>
                        </div>
                    </div>
                    <% })%>
                
                </div>
        </div>
    </div>
</body>
</html>
